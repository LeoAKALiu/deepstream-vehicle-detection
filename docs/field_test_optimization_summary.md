# 现场测试问题优化总结

## 优化内容

### 1. 检测框闪烁问题 ✅

**问题分析：** 检测阈值过低和跟踪参数不稳定导致检测框频繁出现/消失

**优化措施：**
- **检测置信度阈值：** 0.6 → 0.7（提高检测稳定性）
- **NMS IoU阈值：** 0.6 → 0.5（适中平衡）
- **ByteTrack跟踪阈值：** 0.5 → 0.6（减少低质量跟踪）
- **高置信度阈值：** 0.6 → 0.7（与检测阈值一致）
- **IoU匹配阈值：** 0.8 → 0.7（提高跟踪稳定性）
- **跟踪缓冲区：** 30 → 50帧（减少ID切换）

**预期效果：** 减少检测框闪烁，降低虚假车辆计数

### 2. Cassia启动延迟问题 ✅

**问题分析：** Cassia客户端启动后需要时间建立连接，导致初期将已备案车辆误报为未备案

**优化措施：**
- 在Cassia客户端启动后添加3秒等待时间
- 检查初始扫描状态并给出提示
- 显示初始扫描到的信标数量

**预期效果：** 减少系统启动初期的误报

### 3. 车牌识别性能优化 ✅

**问题分析：** 输入分辨率过低，图像预处理不足，导致识别率低

**优化措施：**
- **最小尺寸提升：** 50×150 → 120×320像素
- **最大尺寸提升：** 300×800 → 400×1000像素
- **插值方法：** INTER_LINEAR → INTER_CUBIC（更好的图像质量）
- **增强预处理：**
  - 双边滤波去噪
  - 锐化滤波器增强边缘
  - 更强的CLAHE对比度增强（clipLimit: 2.0 → 3.0）

**预期效果：** 提高车牌识别触发率和准确率

## 配置文件变更

### config.yaml
```yaml
detection:
  conf_threshold: 0.7  # 从0.6提升
  iou_threshold: 0.5   # 从0.6调整

tracking:
  track_thresh: 0.6    # 从0.5提升
  high_thresh: 0.7     # 从0.6提升
  match_thresh: 0.7    # 从0.8降低
  track_buffer: 50     # 从30增加
```

## 测试建议

### 1. 检测稳定性测试
```bash
./start_field_test_display.sh
```
观察：
- 检测框是否稳定
- 车辆计数是否准确
- ID切换是否减少

### 2. 信标匹配测试
```bash
# 重启系统，观察启动后3-5秒内的行为
./start_field_test_display.sh
```
观察：
- 系统启动后是否立即误报
- 3秒后信标匹配是否正常

### 3. 车牌识别测试
使用不同距离、角度的车辆测试：
- 近距离（2-5米）
- 中距离（5-10米）
- 不同光照条件

## 性能监控

建议在测试过程中监控：
- FPS是否稳定（目标：>15fps）
- GPU内存使用率
- 检测延迟

## 后续优化方向

如果问题仍然存在，可考虑：
1. **检测模型优化：** 重新训练或调整模型
2. **多帧融合：** 使用多帧信息提高稳定性
3. **车牌识别模型：** 考虑更先进的识别算法
4. **硬件升级：** 提升相机分辨率或处理能力

---
*优化完成时间：2025-11-21*
*测试环境：Jetson + Orbbec Gemini 335L + Cassia Router*



